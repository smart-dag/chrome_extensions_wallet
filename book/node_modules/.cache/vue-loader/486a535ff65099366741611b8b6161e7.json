{"remainingRequest":"/home/scott/chrome_extensions_wallet/book/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/scott/chrome_extensions_wallet/book/src/views/ShopCar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/scott/chrome_extensions_wallet/book/src/views/ShopCar.vue","mtime":1559802974322},{"path":"/home/scott/chrome_extensions_wallet/book/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/scott/chrome_extensions_wallet/book/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/scott/chrome_extensions_wallet/book/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n//载入对话框组件\nimport { Dialog } from \"vant\";\nexport default {\n  name: \"shopcar\",\n  components: {},\n  created() {\n    //页面被创建后，更新总价。\n    this.upamount();\n  },\n  methods: {\n    download() {\n      window.open(\n        \"https://github.com/smart-dag/chrome_extensions_wallet/releases\"\n      );\n    },\n    //更新总价\n    upamount() {\n      var amount = 0;\n      this.$store.state.shopcarlist.forEach(element => {\n        if (element.checked) {\n          amount += element.price * element.num;\n        }\n      });\n      // this.text = `总金额 ${amount.toFixed(2)}`;\n      this.price = amount.toFixed(2) * 100;\n      if (this.price > 0) {\n        this.pay_btn_disabled = false;\n        this.pay_btn_text = \"立刻支付\";\n      } else {\n        this.pay_btn_disabled = true;\n        this.pay_btn_text = \"请选商品\";\n      }\n    },\n    //支付按钮被点击\n    pay() {\n      let _self = this;\n      if (typeof window.sdag == \"undefined\") {\n        this.show_no_sdag_wallet = true;\n      } else {\n        this.show = true;\n        sdag.pay(\n          \"DDZOSUYQ5TRVDKJPKREDUL473LJP5ZRV\",\n          _self.price/100,\n          `图书订单，共${this.price/100}SDG`,\n          function(hash) {\n            Dialog.alert({\n              title: \"付款成功\",\n              message: `hash:${hash}`\n            }).then(() => {\n              //循环购物车，把已经购买的给删掉。留下没有购买的（未打勾的）\n              _self.show = false;\n              var list = [];\n              _self.$store.state.shopcarlist.forEach(element => {\n                if (!element.checked) {\n                  list.push(element);\n                }\n              });\n              _self.$store.state.shopcarlist = list;\n            });\n          }\n        );\n      }\n      // this.show = true;\n      // Dialog.alert({\n      //   title: \"付款成功\",\n      //   message: \"\"\n      // }).then(() => {\n      //   //循环购物车，把已经购买的给删掉。留下没有购买的（未打勾的）\n      //   var list = [];\n      //   this.$store.state.shopcarlist.forEach(element => {\n      //     if (!element.checked) {\n      //       list.push(element);\n      //     }\n      //   });\n      //   this.$store.state.shopcarlist = list;\n      // });\n    },\n    //回到首页，路由跳转\n    gohome() {\n      this.$router.push({\n        path: \"/\",\n        name: \"home\"\n      });\n    },\n    //减\n    sub(index) {\n      this.$store.state.shopcarlist[index].num -= 1;\n      if (this.$store.state.shopcarlist[index].num < 1) {\n        this.del(index);\n      }\n      this.upamount();\n    },\n    //加\n    add(index) {\n      this.$store.state.shopcarlist[index].num += 1;\n      this.upamount();\n    },\n    //删\n    del(index) {\n      this.$store.state.shopcarlist.splice(index, 1);\n      this.upamount();\n    }\n  },\n  watch: {\n    //对全选按钮进行监控\n    checked(newvalue, oldvalue) {\n      //循环每个商品，更新选择状态\n      this.$store.state.shopcarlist.forEach(element => {\n        if (newvalue) {\n          element.checked = true;\n        } else {\n          element.checked = false;\n        }\n      });\n      this.upamount();\n    }\n  },\n  data() {\n    return {\n      show: false,\n      show_no_sdag_wallet: false,\n      pay_btn_text: \"\", //支付按钮的文本\n      pay_btn_disabled: false, //支付按钮能否现实\n      checked: false, //全选按钮\n      price: 0, //总价\n      active: 1 //当前的底部菜单序列号（颜色变换）\n    };\n  }\n};\n",{"version":3,"sources":["ShopCar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShopCar.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"shopcar\">\n    <van-nav-bar :fixed=\"true\" title=\"我的购物车\" left-text=\"返回\" left-arrow @click-left=\"gohome\"/>\n    <van-card\n      :num=\"item.num\"\n      :price=\"item.price\"\n      :title=\"item.title\"\n      :thumb=\"item.img\"\n      :key=\"$index\"\n      currency=\"SDG\"\n      v-for=\"(item, $index) in $store.state.shopcarlist\"\n    >\n      <div slot=\"footer\">\n        <van-checkbox class=\"selectshop\" @change=\"upamount\" v-model=\"item.checked\"></van-checkbox>\n        <van-button class=\"cp\" size=\"mini\" @click=\"sub($index)\">-</van-button>\n        <van-button class=\"cp\" size=\"mini\" @click=\"add($index)\">+</van-button>\n        <van-button size=\"mini\" @click=\"del($index)\" type=\"danger\">删除</van-button>\n      </div>\n    </van-card>\n\n    <van-submit-bar\n      v-if=\"this.$store.state.shopcarlist.length>0\"\n      :price=\"price\"\n      :disabled=\"pay_btn_disabled\"\n      :button-text=\"pay_btn_text\"\n      currency=\"SDG\"\n      @submit=\"pay\"\n    >\n      <van-checkbox v-model=\"checked\" class=\"selectall\">全选</van-checkbox>\n    </van-submit-bar>\n    <van-action-sheet v-model=\"show_no_sdag_wallet\" title=\"提示\">\n      <p>你还没有安装SDAG的chrome扩展钱包</p>\n      <van-button @click=\"download\" type=\"danger\">立刻下载</van-button>\n      <p></p>\n    </van-action-sheet>\n    <van-action-sheet v-model=\"show\" title>\n      <p>正在等待付款</p>\n      <p></p>\n    </van-action-sheet>\n  </div>\n</template>\n<style scoped>\n.shopcar {\n  padding-top: 35px;\n  margin-bottom: 50px;\n}\n.van-card__header {\n  margin-left: 40px;\n}\n.selectshop {\n  margin-top: -60px;\n  position: absolute;\n  border: solid 1px #ccc;\n  border-radius: 100%;\n}\n.cp {\n  width: 40px;\n  min-width: 40px;\n}\n.selectall {\n  margin-left: 15px;\n}\n</style>\n\n<script>\n//载入对话框组件\nimport { Dialog } from \"vant\";\nexport default {\n  name: \"shopcar\",\n  components: {},\n  created() {\n    //页面被创建后，更新总价。\n    this.upamount();\n  },\n  methods: {\n    download() {\n      window.open(\n        \"https://github.com/smart-dag/chrome_extensions_wallet/releases\"\n      );\n    },\n    //更新总价\n    upamount() {\n      var amount = 0;\n      this.$store.state.shopcarlist.forEach(element => {\n        if (element.checked) {\n          amount += element.price * element.num;\n        }\n      });\n      // this.text = `总金额 ${amount.toFixed(2)}`;\n      this.price = amount.toFixed(2) * 100;\n      if (this.price > 0) {\n        this.pay_btn_disabled = false;\n        this.pay_btn_text = \"立刻支付\";\n      } else {\n        this.pay_btn_disabled = true;\n        this.pay_btn_text = \"请选商品\";\n      }\n    },\n    //支付按钮被点击\n    pay() {\n      let _self = this;\n      if (typeof window.sdag == \"undefined\") {\n        this.show_no_sdag_wallet = true;\n      } else {\n        this.show = true;\n        sdag.pay(\n          \"DDZOSUYQ5TRVDKJPKREDUL473LJP5ZRV\",\n          _self.price/100,\n          `图书订单，共${this.price/100}SDG`,\n          function(hash) {\n            Dialog.alert({\n              title: \"付款成功\",\n              message: `hash:${hash}`\n            }).then(() => {\n              //循环购物车，把已经购买的给删掉。留下没有购买的（未打勾的）\n              _self.show = false;\n              var list = [];\n              _self.$store.state.shopcarlist.forEach(element => {\n                if (!element.checked) {\n                  list.push(element);\n                }\n              });\n              _self.$store.state.shopcarlist = list;\n            });\n          }\n        );\n      }\n      // this.show = true;\n      // Dialog.alert({\n      //   title: \"付款成功\",\n      //   message: \"\"\n      // }).then(() => {\n      //   //循环购物车，把已经购买的给删掉。留下没有购买的（未打勾的）\n      //   var list = [];\n      //   this.$store.state.shopcarlist.forEach(element => {\n      //     if (!element.checked) {\n      //       list.push(element);\n      //     }\n      //   });\n      //   this.$store.state.shopcarlist = list;\n      // });\n    },\n    //回到首页，路由跳转\n    gohome() {\n      this.$router.push({\n        path: \"/\",\n        name: \"home\"\n      });\n    },\n    //减\n    sub(index) {\n      this.$store.state.shopcarlist[index].num -= 1;\n      if (this.$store.state.shopcarlist[index].num < 1) {\n        this.del(index);\n      }\n      this.upamount();\n    },\n    //加\n    add(index) {\n      this.$store.state.shopcarlist[index].num += 1;\n      this.upamount();\n    },\n    //删\n    del(index) {\n      this.$store.state.shopcarlist.splice(index, 1);\n      this.upamount();\n    }\n  },\n  watch: {\n    //对全选按钮进行监控\n    checked(newvalue, oldvalue) {\n      //循环每个商品，更新选择状态\n      this.$store.state.shopcarlist.forEach(element => {\n        if (newvalue) {\n          element.checked = true;\n        } else {\n          element.checked = false;\n        }\n      });\n      this.upamount();\n    }\n  },\n  data() {\n    return {\n      show: false,\n      show_no_sdag_wallet: false,\n      pay_btn_text: \"\", //支付按钮的文本\n      pay_btn_disabled: false, //支付按钮能否现实\n      checked: false, //全选按钮\n      price: 0, //总价\n      active: 1 //当前的底部菜单序列号（颜色变换）\n    };\n  }\n};\n</script>\n"]}]}